"use strict";(self.webpackChunkednar_admin_docs=self.webpackChunkednar_admin_docs||[]).push([[3385],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return g}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),p=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return a.createElement(d.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),m=p(n),c=r,g=m["".concat(d,".").concat(c)]||m[c]||u[c]||i;return n?a.createElement(g,l(l({ref:t},s),{},{components:n})):a.createElement(g,l({ref:t},s))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o[m]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2866:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return d},default:function(){return g},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),l=["components"],o={id:"ednar-reporting-service",title:"EDNAR Reporting Service",slug:"/ednar-reporting-service",hide_table_of_contents:!0},d=void 0,p={unversionedId:"ednar-reporting-service",id:"version-6.3.0/ednar-reporting-service",title:"EDNAR Reporting Service",description:"The EDNAR Reporting Service exposes an API which allows EDNAR server to:",source:"@site/versioned_docs/version-6.3.0/ednar-reporting-service.mdx",sourceDirName:".",slug:"/ednar-reporting-service",permalink:"/ednar/docs/admin/6.3.0/ednar-reporting-service",draft:!1,tags:[],version:"6.3.0",frontMatter:{id:"ednar-reporting-service",title:"EDNAR Reporting Service",slug:"/ednar-reporting-service",hide_table_of_contents:!0},sidebar:"version-6.3.0-sidebar",previous:{title:"EDNAR Web Client",permalink:"/ednar/docs/admin/6.3.0/ednar-web-client"},next:{title:"EDNAR DMS Agent",permalink:"/ednar/docs/admin/6.3.0/ednar-dms-agent"}},s={},m=[{value:"Required Software",id:"required-software",level:2},{value:"Installing EdnarReportingService",id:"installing-ednarreportingservice",level:2},{value:"Uninstalling EdnarReportingService",id:"uninstalling-ednarreportingservice",level:2},{value:"Configuring EdnarReportingService",id:"configuring-ednarreportingservice",level:2}],u={toc:m},c="wrapper";function g(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)(c,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The EDNAR Reporting Service exposes an API which allows EDNAR server to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Generate NAR PDF."),(0,i.kt)("li",{parentName:"ul"},"Generate NAR attachment PDF."),(0,i.kt)("li",{parentName:"ul"},"Generate customer list PDF."),(0,i.kt)("li",{parentName:"ul"},"Generate the switching instruction PDF from the DMS database.")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"required-software"},"Required Software"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"At least Windows 7 operating system with SP1 or above is required"),(0,i.kt)("li",{parentName:"ul"},".NET Framework 4.6.1 or higher"),(0,i.kt)("li",{parentName:"ul"},"Aspose.Total (included)")),(0,i.kt)("h2",{id:"installing-ednarreportingservice"},"Installing EdnarReportingService"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"You need administrator privileges to install the service.")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Login to the windows machine in which EdnarService needs to be installed."),(0,i.kt)("li",{parentName:"ul"},"Create a folder ",(0,i.kt)("inlineCode",{parentName:"li"},"EdnarReportingService"),"."),(0,i.kt)("li",{parentName:"ul"},"Copy all the EdnarReportingService binaries from the ",(0,i.kt)("inlineCode",{parentName:"li"},".zip")," file of the release to this folder."),(0,i.kt)("li",{parentName:"ul"},"Copy the Aspose license file to folder ",(0,i.kt)("inlineCode",{parentName:"li"},"EdnarReportingService"),"."),(0,i.kt)("li",{parentName:"ul"},"Change the config file to make sure it is correct in the running environment."),(0,i.kt)("li",{parentName:"ul"},"Run Powershell as an administrator and use it to navigate to the ",(0,i.kt)("inlineCode",{parentName:"li"},"EdnarReportingService")," directory."),(0,i.kt)("li",{parentName:"ul"},"Run  ",(0,i.kt)("inlineCode",{parentName:"li"},".\\ednar-reporting-service.exe install")," and wait for a message to say that it was successfully installed."),(0,i.kt)("li",{parentName:"ul"},"The EdnarReportingService windows service is now installed."),(0,i.kt)("li",{parentName:"ul"},"Go to the Services console in windows."),(0,i.kt)("li",{parentName:"ul"},"Make sure the ",(0,i.kt)("inlineCode",{parentName:"li"},"EDNAR Reporting Service")," service is running. If not, start it."),(0,i.kt)("li",{parentName:"ul"},"Check the properties of the ",(0,i.kt)("inlineCode",{parentName:"li"},"EDNAR Reporting Service")," service to ensure that it is configured to start automatically.")),(0,i.kt)("h2",{id:"uninstalling-ednarreportingservice"},"Uninstalling EdnarReportingService"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"You need administrator privileges to uninstall the service.")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Login to the windows machine in which EdnarReportingService is installed."),(0,i.kt)("li",{parentName:"ul"},"Run Powershell as an administrator."),(0,i.kt)("li",{parentName:"ul"},"Navigate to ",(0,i.kt)("inlineCode",{parentName:"li"},"\\EdnarReportingService"),"."),(0,i.kt)("li",{parentName:"ul"},"Run the command ",(0,i.kt)("inlineCode",{parentName:"li"},".\\ednar-reporting-service.exe uninstall")),(0,i.kt)("li",{parentName:"ul"},"You should get an uninstall successful message.")),(0,i.kt)("h2",{id:"configuring-ednarreportingservice"},"Configuring EdnarReportingService"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Navigate to ",(0,i.kt)("inlineCode",{parentName:"li"},"C:\\EdnarReportingService"),"."),(0,i.kt)("li",{parentName:"ul"},"Open the file ",(0,i.kt)("inlineCode",{parentName:"li"},"ednar-reporting-service.exe.config")," in the text editor of choice."),(0,i.kt)("li",{parentName:"ul"},"Update the configuration items as specified below. Save and close the file. Restart EdnarReportingService for the new configuration to take effect.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<add key="EdnarReportingServicePort" value="8010" />\n<add key="LogFileRelativePath" value="Logs\\" />\n<add key="ServerBaseUrl" value="http://+:" />\n<add key="LocalRequestOnly" value="true" />\n<add key="ReportTemplateFile" value="report-template\\\\schedule_job_report" />\n<add key="DocumentDefinitionFile" value="report-template\\\\PCA_SCHEDULED_JOB_HEADER.xml" />\n<add key="CustomersExcelTemplateFile" value="report-template\\\\CustomersReportTemplate.xlsx" />\n<add key="CustomersExcelTemplateFilePON" value="report-template\\\\CustomersReportTemplatePON.xlsx" />\n<add key="CITIHandCardWordTemplateFile" value="report-template\\\\CitiPower Hand Card.doc" />\n<add key="PCORHandCardWordTemplateFile" value="report-template\\\\Powercor Hand Card.doc" />\n<add key="MaxConcurrentRequestsLimit" value="2" />\n<add key="MaxQueueRequestsLimit" value="8" />\n<add key="AsposeLicense" value="Aspose.Total.lic" />\n<add key="EwbBaseUrl" value="http://localhost:9000/" />\n<add key="ValidPermitsOnly" value="true" />\n<add key="CollateSWLogFields" value="0" />\n<add key="serilog:write-to:File.outputTemplate" value="{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} &lt;{ThreadId}&gt; &lt;{RequestId}&gt;{NewLine}{Exception}" />\n<add key="serilog:write-to:File.retainedFileCountLimit" value="10" />\n<add key="serilog:minimum-level" value="Debug" />\n<cdmAppSettings>\n    <add key="BaseUrl" value="http://localhost:9988/" />\n    <add key="Username" value="xxx" />\n    <add key="Password" value="yyy" />\n    <add key="TrustAllCertificates" value="false" />\n    <add key="VerifyHost" value="true" />\n</cdmAppSettings>\n<permitTemplates>\n    <add key="default" value="report-template\\\\NP_TEST_PERMIT" />\n    <add key="Access Permit" value="report-template\\\\NP_ACCESS_PERMIT" />\n    <add key="Live Line Permit" value="report-template\\\\NP_LIVE_LINE_PERMIT" />\n    <add key="Close Working Zone Permit" value="report-template\\\\NP_CLOSE_WORKING_ZONE_PERMIT" />\n</permitTemplates>\n\x3c!-- Use ONE of these two connection string formats depending on database format (Oracle or MS SQL Server) --\x3e\n\x3c!-- SQL Server: --\x3e\n<add name="EdnarDB" connectionString="Server=my-sql-server;Database=ednar;User Id=ednar;Password=password;" />\n\x3c!-- Oracle: --\x3e\n<add name="EdnarDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=EDNAR;Password=password;" />\n\x3c!-- See above EdnarDB format for SQL Server DmsDB connection strings--\x3e\n<add name="DmsDb" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=enmac;Password=password;" /> or use environment variable `DMS_DB_CONN_STR`\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Config Item"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"EdnarReportingServicePort")),(0,i.kt)("td",{parentName:"tr",align:null},"EdnarReportingService port number")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"LogFileRelativePath")),(0,i.kt)("td",{parentName:"tr",align:null},"Path of the log files relative to the deployment directory. A path of Logs\\ will create the log file in ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\EdnarService\\Logs")," if the deployment directory is ",(0,i.kt)("inlineCode",{parentName:"td"},"C:\\EdnarService"),". Log file is created in text format and the rolling interval is set to a day.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ServerBaseUrl")),(0,i.kt)("td",{parentName:"tr",align:null},"Base server URL that will be used by the client to send http requests e.g. https://+:.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"LocalRequestOnly")),(0,i.kt)("td",{parentName:"tr",align:null},"The flag to set if only the local request is valid.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ReportTemplateFile")),(0,i.kt)("td",{parentName:"tr",align:null},"The switching instruction report template file path including the filename.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"DocumentDefinitionFile")),(0,i.kt)("td",{parentName:"tr",align:null},"The switching instruction document definition XML file path including the filename.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"CustomersExcelTemplateFile")),(0,i.kt)("td",{parentName:"tr",align:null},"The customers report template file, including the path name.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"CustomersExcelTemplateFilePON")),(0,i.kt)("td",{parentName:"tr",align:null},"The customers report template file that will be used for PON, including the path name")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"CITIHandCardWordTemplateFile")),(0,i.kt)("td",{parentName:"tr",align:null},"The hand card template of CitiPower, including the path name")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"PCORHandCardWordTemplateFile")),(0,i.kt)("td",{parentName:"tr",align:null},"The hand card template of Powercor, including the path name")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"MaxConcurrentRequestsLimit")),(0,i.kt)("td",{parentName:"tr",align:null},"The maximum count of reports that will be created at the same time. This limits the memory consumption of the service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"MaxQueueRequestsLimit")),(0,i.kt)("td",{parentName:"tr",align:null},"The maximum count of requests that will be put into queue once MaxConcurrentRequestsLimit has been reached. This affects users having to wait for a long time for the report to be generated. Instead, once the limit has been reached, the service will immediately return 503 Service Unavailable.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"AsposeLicense")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"The Aspose license file, including the path name. When not specified, the license should be on the same directory with the executable files.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"EwbBaseUrl")),(0,i.kt)("td",{parentName:"tr",align:null},"HTTP base url of the Energy Workbench Server. Note: /ewb is not defined in the service. Hence; must be included in the base url.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ValidPermitsOnly")),(0,i.kt)("td",{parentName:"tr",align:null},"Flag to set if only valid permits (e.g. permits attached to a current/valid switching step) should be printed. Default is True.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"CollateSWLogFields")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Flag to set if COLLATE_SW_LOG_FIELDS is enabled in the ENMAC.SYSTEM_PARAMETERS DMS database table. 1 for true, 0 for false, default is 0")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"serilog:write-to:File.outputTemplate")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Sets the output template of file log.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"serilog:write-to:File.retainedFileCountLimit")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"The maximum number of log files that will be retained, including the current log file. Defaults to 31 when not specified.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"serilog:minimum-level")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Sets the minimum log level.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cdmAppSettings")," - ",(0,i.kt)("inlineCode",{parentName:"td"},"BaseUrl")),(0,i.kt)("td",{parentName:"tr",align:null},"HTTP base url of the customer data management service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cdmAppSettings")," - ",(0,i.kt)("inlineCode",{parentName:"td"},"Username")),(0,i.kt)("td",{parentName:"tr",align:null},"Username for authentication with customer data management service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cdmAppSettings")," - ",(0,i.kt)("inlineCode",{parentName:"td"},"Password")),(0,i.kt)("td",{parentName:"tr",align:null},"Password for authentication with customer data management service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cdmAppSettings")," - ",(0,i.kt)("inlineCode",{parentName:"td"},"TrustAllCertificates")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Defaults to ",(0,i.kt)("inlineCode",{parentName:"td"},"true"),", will not allow untrusted ssl certificate.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"cdmAppSettings")," - ",(0,i.kt)("inlineCode",{parentName:"td"},"VerifyHost")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Defaults to ",(0,i.kt)("inlineCode",{parentName:"td"},"true"),", will verify ssl certificate against hostname.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"permitTemplates")," (optional)"),(0,i.kt)("td",{parentName:"tr",align:null},"Collection of permit templates where key is the permit type and values is the path to the template file. Note that it needs to have a default key for the reporting service to fall back on when there is no config for the permit type or the specified config value of permit type is not found.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Connection String - ",(0,i.kt)("inlineCode",{parentName:"td"},"EdnarDB")),(0,i.kt)("td",{parentName:"tr",align:null},"Specify the connection string for the EDNAR database, can be Oracle or MS SQL.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Connection String - ",(0,i.kt)("inlineCode",{parentName:"td"},"DmsDb")),(0,i.kt)("td",{parentName:"tr",align:null},"Specify the connection string for the DMS database, can be Oracle or MS SQL.")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The port number needs to be consistent with the EDNAR App Server configuration.")))}g.isMDXComponent=!0}}]);