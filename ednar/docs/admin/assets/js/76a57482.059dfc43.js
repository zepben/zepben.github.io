"use strict";(self.webpackChunkednar_admin_docs=self.webpackChunkednar_admin_docs||[]).push([[6989],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return E}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(n),d=a,E=m["".concat(l,".").concat(d)]||m[d]||u[d]||r;return n?i.createElement(E,o(o({ref:t},p),{},{components:n})):i.createElement(E,o({ref:t},p))}));function E(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[m]="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8580:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return E},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return m}});var i=n(7462),a=n(3366),r=(n(7294),n(3905)),o=["components"],s={id:"ednar-oms-service",title:"EDNAR OMS Service",slug:"/ednar-oms-service"},l="Introduction",c={unversionedId:"ednar-oms-service",id:"version-6.3.0/ednar-oms-service",title:"EDNAR OMS Service",description:"The implementation of the EDNAR OMS Service is bespoke, as its operation requires integration with other corporate systems.",source:"@site/versioned_docs/version-6.3.0/ednar-oms-service.md",sourceDirName:".",slug:"/ednar-oms-service",permalink:"/ednar/docs/admin/6.3.0/ednar-oms-service",draft:!1,tags:[],version:"6.3.0",frontMatter:{id:"ednar-oms-service",title:"EDNAR OMS Service",slug:"/ednar-oms-service"},sidebar:"version-6.3.0-sidebar",previous:{title:"EDNAR Controller PDF",permalink:"/ednar/docs/admin/6.3.0/ednar-controller-pdf"},next:{title:"EDNAR User Management Service",permalink:"/ednar/docs/admin/6.3.0/ednar-user-management-service"}},p={},m=[],u={toc:m},d="wrapper";function E(e){var t=e.components,n=(0,a.Z)(e,o);return(0,r.kt)(d,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"introduction"},"Introduction"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"The implementation of the EDNAR OMS Service is bespoke, as its operation requires integration with other corporate systems.")),(0,r.kt)("p",null,"EDNAR OMS Service runs as a windows service to synchronize customer notifications between EDNAR and OMS database at a specified time interval."),(0,r.kt)("p",null,"Customer notifications will be saved in OMS database by executing a stored procedure named ",(0,r.kt)("inlineCode",{parentName:"p"},"save_nar_customer_notifications"),", passing in sql type ",(0,r.kt)("inlineCode",{parentName:"p"},"nars_typ"),". See SQL Type section for the type structure."),(0,r.kt)("p",null,"The software runs as a windows service. It is built using .NET and can run only on windows."),(0,r.kt)("hr",null),(0,r.kt)("h1",{id:"required-software"},"Required Software"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Atleast Windows 7 operating system with SP1 or above is required"),(0,r.kt)("li",{parentName:"ul"},".NET Framework 4.6.2")),(0,r.kt)("h1",{id:"installing-ednar-oms-service"},"Installing EDNAR-OMS Service"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"You need administrator privileges to install the service.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Login to the windows machine in which ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," needs to be installed."),(0,r.kt)("li",{parentName:"ul"},"Create a folder ",(0,r.kt)("inlineCode",{parentName:"li"},"EdnarOmsService"),"."),(0,r.kt)("li",{parentName:"ul"},"Copy all the EDNAR-OMS Service binaries from the ",(0,r.kt)("inlineCode",{parentName:"li"},".zip")," file of the release to this folder."),(0,r.kt)("li",{parentName:"ul"},"Change the config file to make sure it is correct in the running environment."),(0,r.kt)("li",{parentName:"ul"},"Run Powershell as an administrator and use it to navigate to the ",(0,r.kt)("inlineCode",{parentName:"li"},"EdnarOmsService")," directory."),(0,r.kt)("li",{parentName:"ul"},"Run  ",(0,r.kt)("inlineCode",{parentName:"li"},".\\ednar-oms-service.exe install")," and wait for a message to say that it was successfully installed."),(0,r.kt)("li",{parentName:"ul"},"You should get the installed successfully message."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," windows service is installed at this point."),(0,r.kt)("li",{parentName:"ul"},"Go to the Services console in windows."),(0,r.kt)("li",{parentName:"ul"},"Make sure the ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," service is running. If not, start it."),(0,r.kt)("li",{parentName:"ul"},"Check the properties of the ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," service to ensure that it is configured to start automatically.")),(0,r.kt)("h1",{id:"uninstalling-ednar-oms-service"},"Uninstalling EDNAR-OMS Service"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"You need administrator privileges to uninstall the service.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Login to the windows machine in which ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," is installed."),(0,r.kt)("li",{parentName:"ul"},"Run Powershell as an administrator."),(0,r.kt)("li",{parentName:"ul"},"Navigate to ",(0,r.kt)("inlineCode",{parentName:"li"},"C:\\EdnarOmsService"),"."),(0,r.kt)("li",{parentName:"ul"},"Run the command ",(0,r.kt)("inlineCode",{parentName:"li"},".\\ednar-oms-service.exe uninstall")),(0,r.kt)("li",{parentName:"ul"},"You should get an uninstall successful message.")),(0,r.kt)("h1",{id:"configuring-ednar-oms-service"},"Configuring Ednar-OMS Service"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Navigate to ",(0,r.kt)("inlineCode",{parentName:"li"},"C:\\EdnarOmsService"),"."),(0,r.kt)("li",{parentName:"ul"},"Open the file ",(0,r.kt)("inlineCode",{parentName:"li"},"ednar-oms-service.exe.config")," in the text editor of choice."),(0,r.kt)("li",{parentName:"ul"},"Update the configuration items as specified below. Save and close the file. Restart ",(0,r.kt)("inlineCode",{parentName:"li"},"EDNAR-OMS Service")," for the new configuration to take effect.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<add key="DBConnectionRetries" value="2" />\n<add key="RunInterval" value="60" />\n<connectionStrings>\n    <add name="EdnarOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n    <add name="DMSOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n    <add name="PonOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n</connectionStrings>\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Config Item"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"DBConnectionRetries"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of retries the service will use to try to connect to the database before giving up.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RunInterval"),(0,r.kt)("td",{parentName:"tr",align:null},"The amount of time in seconds that the service will sleep before running a new task.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Connection String - ",(0,r.kt)("inlineCode",{parentName:"td"},"EdnarDB")),(0,r.kt)("td",{parentName:"tr",align:null},"Specify the connection string for the EDNAR database in oracle.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Connection String - ",(0,r.kt)("inlineCode",{parentName:"td"},"OmsDB")),(0,r.kt)("td",{parentName:"tr",align:null},"Specify the connection string for the OMS database in oracle.")))),(0,r.kt)("h1",{id:"sql-type"},"SQL Type"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"-- Customer Notification Template\nCREATE OR REPLACE TYPE template_typ AS OBJECT (\n   id NUMBER(38,0),\n   name VARCHAR2(256)\n);\n\n-- Customer Notification Task NMI\nCREATE OR REPLACE TYPE nmi_typ AS OBJECT (\n   nmi VARCHAR2(256)\n);\nCREATE OR REPLACE TYPE nmis_typ AS TABLE OF nmi_typ;\n\n\n-- Customer Notification Event Reason Type\nCREATE OR REPLACE TYPE customer_notification_event_reason_typ AS OBJECT (\n   id NUMBER(38,0),\n   name VARCHAR2(256),\n   type VARCHAR2(128)\n);\n\n-- Customer Notification Event\nCREATE OR REPLACE TYPE customer_notification_event_typ AS OBJECT (\n   id NUMBER(38,0),\n   template template_typ,\n   reason customer_notification_event_reason_typ,\n   created_on TIMESTAMP(6),\n   nmis nmis_typ\n);\nCREATE OR REPLACE TYPE customer_notification_events_typ AS TABLE OF customer_notification_event_typ;\n\n-- Customer Notification\n-- Customer Notification Task\nCREATE OR REPLACE TYPE customer_notification_task_typ AS OBJECT(\n   company VARCHAR2(128),\n   description VARCHAR2(256),\n   outage_start TIMESTAMP(6),\n   outage_end TIMESTAMP(6),\n   template template_typ,\n   delivery_method VARCHAR2(256),\n   nmis nmis_typ,\n   events customer_notification_events_typ\n);\nCREATE OR REPLACE TYPE customer_notification_tasks_typ AS TABLE OF customer_notification_task_typ;\n\n-- NAR Access Type\nCREATE OR REPLACE TYPE access_type_typ AS OBJECT(\n   id NUMBER(38,0),\n   name VARCHAR2(128)\n);\n\n-- NAR Job Type\nCREATE OR REPLACE TYPE job_type_typ AS OBJECT(\n   id NUMBER(38,0),\n   name VARCHAR2(128)\n);\n\n-- User\nCREATE OR REPLACE TYPE user_typ AS OBJECT (\n   username VARCHAR2(256),\n   first_name VARCHAR2(128),\n   last_name VARCHAR2(128),\n   email VARCHAR2(256),\n   fax VARCHAR2(32),\n   depot VARCHAR2(64),\n   mobile VARCHAR2(32),\n   phone VARCHAR2(32),\n   position VARCHAR2(128)\n);\n\n-- NAR Comment\nCREATE OR REPLACE TYPE nar_comment_typ AS OBJECT (\n    id NUMBER(38, 0),\n    comment_timestamp TIMESTAMP(6),\n    comment_user user_typ,\n    type VARCHAR2(100),\n    text VARCHAR2(4000)\n);\nCREATE OR REPLACE TYPE nar_comments_typ AS TABLE OF nar_comment_typ;\n\n-- NAR Participant\n-- Participant Type\nCREATE OR REPLACE TYPE participant_typ AS OBJECT (\n   participant_type VARCHAR2(128),\n   participant_user user_typ\n);\nCREATE OR REPLACE TYPE participants_typ AS TABLE OF participant_typ;\n\n-- NAR\nCREATE OR REPLACE TYPE nar_typ AS OBJECT(\n   id NUMBER(38,0),\n   state VARCHAR2(128),\n   access_type access_type_typ,\n   job_type job_type_typ,\n   start_date_time TIMESTAMP(6),\n   end_date_time TIMESTAMP(6),\n   primary_equipment_container VARCHAR2(128),\n   work_title VARCHAR2(128),\n   location VARCHAR2(128),\n   participants participants_typ,\n   customer_notification_tasks customer_notification_tasks_typ,\n   comments nar_comments_typ\n);\nCREATE OR REPLACE TYPE nars_typ AS TABLE OF nar_typ\n")))}E.isMDXComponent=!0}}]);