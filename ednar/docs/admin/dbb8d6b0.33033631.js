(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{240:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return s})),a.d(t,"toc",(function(){return c})),a.d(t,"default",(function(){return p}));var n=a(3),r=a(7),o=(a(0),a(281)),i={id:"export-sql-server-config",title:"Exporting SQL Server config",slug:"/export-sql-server-config"},s={unversionedId:"export-sql-server-config",id:"export-sql-server-config",isDocsHomePage:!1,title:"Exporting SQL Server config",description:"This guide runs through the steps of exporting the EDNAR config data from one SQL Server database to another SQL Server database. There are a few other ways to do it, however most of those have issues in one way or another.",source:"@site/docs\\export-sql-server-config.md",slug:"/export-sql-server-config",permalink:"/ednar/docs/admin/next/export-sql-server-config",editUrl:"https://github.com/zepben/docs/export-sql-server-config.md",version:"current",sidebar:"sidebar",previous:{title:"NAR Summary PDF Report Template",permalink:"/ednar/docs/admin/next/report-template"},next:{title:"Steps to debug EDNAR",permalink:"/ednar/docs/admin/next/debugging-steps"}},c=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Steps",id:"steps",children:[]}],l={toc:c};function p(e){var t=e.components,i=Object(r.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},l,i,{components:t,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This guide runs through the steps of exporting the EDNAR config data from one SQL Server database to another SQL Server database. There are a few other ways to do it, however most of those have issues in one way or another. "),Object(o.a)("p",null,"After following the steps below, you will be left with a fully functioning EDNAR database which only contains config data - all transactional data (NARs, Authorities, attachments etc.) will be deleted. The original/source database will not lose any data."),Object(o.a)("hr",null),Object(o.a)("h3",{id:"prerequisites"},"Prerequisites"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"An existing SQL Server database with EDNAR config (referred to as OLD_EDNAR in this guide)"),Object(o.a)("li",{parentName:"ul"},"A new blank SQL Server database that will be used for the new EDNAR DB (referred to as NEW_EDNAR in this guide)"),Object(o.a)("li",{parentName:"ul"},"SQL Server Management Studio (SSMS) installed, logged in as a user with write privileges on the new database (ideally the DB Owner or the user that EDNAR uses to connect to the database)"),Object(o.a)("li",{parentName:"ul"},"This SQL file to remove transactional data and reset the database sequences: ",Object(o.a)("a",{target:"_blank",href:a(306).default},"click to download"))),Object(o.a)("hr",null),Object(o.a)("h3",{id:"steps"},"Steps"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"1.")," In SSMS, open the Object Explorer and locate OLD_EDNAR under the Databases folder. Right click it, then go down to ",Object(o.a)("inlineCode",{parentName:"p"},"Tasks")," > ",Object(o.a)("inlineCode",{parentName:"p"},"Back Up..."),"."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"2.")," In the Back Up Database wizard on the General page, make sure the correct database is selected and the ",Object(o.a)("inlineCode",{parentName:"p"},"Backup type")," is set to Full. Under ",Object(o.a)("inlineCode",{parentName:"p"},"Destination"),", select ",Object(o.a)("inlineCode",{parentName:"p"},"Back up to: Disk"),", then in the box below press ",Object(o.a)("inlineCode",{parentName:"p"},"Add..."),".\nMake sure ",Object(o.a)("inlineCode",{parentName:"p"},"File name:")," is checked, then select a location to create the backup. Set an appropriate filename (e.g. OLD_EDNAR-DD-MM-YYYY.bak) then hit OK. If there are other backup files in the ",Object(o.a)("inlineCode",{parentName:"p"},"Destination")," box, remove them using the button on the right."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"3.")," The rest of the pages should be fine to continue with the default options. Hit OK on the ",Object(o.a)("inlineCode",{parentName:"p"},"General")," page to create the backup."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"4.")," Back in the Object Explorer, find the NEW_EDNAR database. Right click it, then go down to ",Object(o.a)("inlineCode",{parentName:"p"},"Tasks")," > ",Object(o.a)("inlineCode",{parentName:"p"},"Restore")," > ",Object(o.a)("inlineCode",{parentName:"p"},"Database"),"."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"5.")," In the wizard under ",Object(o.a)("inlineCode",{parentName:"p"},"Source"),", either select ",Object(o.a)("inlineCode",{parentName:"p"},"Database:")," and choose OLD_EDNAR, or choose ",Object(o.a)("inlineCode",{parentName:"p"},"Device:"),", then ",Object(o.a)("inlineCode",{parentName:"p"},"Add")," and locate the backup file (*.bak) you created earlier.\nMake sure the Destination database is NEW_EDNAR."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"6.")," On the ",Object(o.a)("inlineCode",{parentName:"p"},"Options")," page of the wizard, check the ",Object(o.a)("inlineCode",{parentName:"p"},"Overwrite the existing database")," box. If you've already set up replication, check the ",Object(o.a)("inlineCode",{parentName:"p"},"Preserve the replication settings")," box as well. Everything else can stay as the default settings."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"7.")," Back on the ",Object(o.a)("inlineCode",{parentName:"p"},"General")," page, hit OK. Verify the restore has worked by opening NEW_EDNAR > Tables and verifying that the EDNAR tables are now listed. "),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"8.")," Right click NEW_EDNAR again, the hit ",Object(o.a)("inlineCode",{parentName:"p"},"New Query"),". Copy the contents of ",Object(o.a)("inlineCode",{parentName:"p"},"delete-transactional-data+restart-sequences.sql")," (download link above) into the query editor. Read the warnings at the top of the file, then hit ",Object(o.a)("inlineCode",{parentName:"p"},"Execute")," in the toolbar above (or press F5) to run the SQL."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"9.")," Once run, point EDNAR at NEW_EDNAR in the config file, then start it. If everything has worked as expected, EDNAR should run up without issue, and when a new NAR is created, the ID should start at 1."))}p.isMDXComponent=!0},281:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s({},t,{},e)),a},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=Object(n.forwardRef)((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(a),h=n,b=u["".concat(i,".").concat(h)]||u[h]||d[h]||o;return a?r.a.createElement(b,s({ref:t},l,{components:a})):r.a.createElement(b,s({ref:t},l))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=a[l];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},306:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/files/delete-transactional-data+restart-sequences-b1332d72a637523d78abee237b9adac3.sql"}}]);