"use strict";(self.webpackChunkednar_app_server=self.webpackChunkednar_app_server||[]).push([["7929"],{19927:function(e,t,n){n.r(t),n.d(t,{metadata:()=>i,default:()=>h,frontMatter:()=>d,contentTitle:()=>l,toc:()=>o,assets:()=>a});var i=JSON.parse('{"id":"ednar-reporting-service","title":"EDNAR Reporting Service","description":"The EDNAR Reporting Service exposes an API which allows EDNAR server to:","source":"@site/versioned_docs/version-6.7.0/ednar-reporting-service.mdx","sourceDirName":".","slug":"/ednar-reporting-service","permalink":"/ednar/docs/ednar-app-server/6.7.0/ednar-reporting-service","draft":false,"unlisted":false,"tags":[],"version":"6.7.0","frontMatter":{"id":"ednar-reporting-service","title":"EDNAR Reporting Service","slug":"/ednar-reporting-service","hide_table_of_contents":true},"sidebar":"version-6.7.0-sidebar","previous":{"title":"EDNAR Web Client","permalink":"/ednar/docs/ednar-app-server/6.7.0/ednar-web-client"},"next":{"title":"EDNAR DMS Agent","permalink":"/ednar/docs/ednar-app-server/6.7.0/ednar-dms-agent"}}'),r=n(74848),s=n(28453);let d={id:"ednar-reporting-service",title:"EDNAR Reporting Service",slug:"/ednar-reporting-service",hide_table_of_contents:!0},l,a={},o=[{value:"Required Software",id:"required-software",level:2},{value:"Installing EdnarReportingService",id:"installing-ednarreportingservice",level:2},{value:"Uninstalling EdnarReportingService",id:"uninstalling-ednarreportingservice",level:2},{value:"Configuring EdnarReportingService",id:"configuring-ednarreportingservice",level:2}];function c(e){let t={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"The EDNAR Reporting Service exposes an API which allows EDNAR server to:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Generate NAR PDF."}),"\n",(0,r.jsx)(t.li,{children:"Generate NAR attachment PDF."}),"\n",(0,r.jsx)(t.li,{children:"Generate customer list PDF."}),"\n",(0,r.jsx)(t.li,{children:"Generate the switching instruction PDF from the DMS database."}),"\n"]}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(t.h2,{id:"required-software",children:"Required Software"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"At least Windows 7 operating system with SP1 or above is required"}),"\n",(0,r.jsx)(t.li,{children:".NET Framework 4.6.1 or higher"}),"\n",(0,r.jsx)(t.li,{children:"Aspose.Total (included)"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"installing-ednarreportingservice",children:"Installing EdnarReportingService"}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsx)(t.p,{children:"You need administrator privileges to install the service."})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Login to the windows machine in which EdnarService needs to be installed."}),"\n",(0,r.jsxs)(t.li,{children:["Create a folder ",(0,r.jsx)(t.code,{children:"EdnarReportingService"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Copy all the EdnarReportingService binaries from the ",(0,r.jsx)(t.code,{children:".zip"})," file of the release to this folder."]}),"\n",(0,r.jsxs)(t.li,{children:["Copy the Aspose license file to folder ",(0,r.jsx)(t.code,{children:"EdnarReportingService"}),"."]}),"\n",(0,r.jsx)(t.li,{children:"Change the config file to make sure it is correct in the running environment."}),"\n",(0,r.jsxs)(t.li,{children:["Run Powershell as an administrator and use it to navigate to the ",(0,r.jsx)(t.code,{children:"EdnarReportingService"})," directory."]}),"\n",(0,r.jsxs)(t.li,{children:["Run  ",(0,r.jsx)(t.code,{children:".\\ednar-reporting-service.exe install"})," and wait for a message to say that it was successfully installed."]}),"\n",(0,r.jsx)(t.li,{children:"The EdnarReportingService windows service is now installed."}),"\n",(0,r.jsx)(t.li,{children:"Go to the Services console in windows."}),"\n",(0,r.jsxs)(t.li,{children:["Make sure the ",(0,r.jsx)(t.code,{children:"EDNAR Reporting Service"})," service is running. If not, start it."]}),"\n",(0,r.jsxs)(t.li,{children:["Check the properties of the ",(0,r.jsx)(t.code,{children:"EDNAR Reporting Service"})," service to ensure that it is configured to start automatically."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"uninstalling-ednarreportingservice",children:"Uninstalling EdnarReportingService"}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsx)(t.p,{children:"You need administrator privileges to uninstall the service."})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Login to the windows machine in which EdnarReportingService is installed."}),"\n",(0,r.jsx)(t.li,{children:"Run Powershell as an administrator."}),"\n",(0,r.jsxs)(t.li,{children:["Navigate to ",(0,r.jsx)(t.code,{children:"\\EdnarReportingService"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Run the command ",(0,r.jsx)(t.code,{children:".\\ednar-reporting-service.exe uninstall"})]}),"\n",(0,r.jsx)(t.li,{children:"You should get an uninstall successful message."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"configuring-ednarreportingservice",children:"Configuring EdnarReportingService"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Navigate to ",(0,r.jsx)(t.code,{children:"C:\\EdnarReportingService"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Open the file ",(0,r.jsx)(t.code,{children:"ednar-reporting-service.exe.config"})," in the text editor of choice."]}),"\n",(0,r.jsx)(t.li,{children:"Update the configuration items as specified below. Save and close the file. Restart EdnarReportingService for the new configuration to take effect."}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:'<add key="EdnarReportingServicePort" value="8010" />\n<add key="LogFileRelativePath" value="Logs\\" />\n<add key="ServerBaseUrl" value="http://+:" />\n<add key="LocalRequestOnly" value="true" />\n<add key="ReportTemplateFile" value="report-template\\\\schedule_job_report" />\n<add key="DocumentDefinitionFile" value="report-template\\\\PCA_SCHEDULED_JOB_HEADER.xml" />\n<add key="CustomersExcelTemplateFile" value="report-template\\\\CustomersReportTemplate.xlsx" />\n<add key="CustomersExcelTemplateFilePON" value="report-template\\\\CustomersReportTemplatePON.xlsx" />\n<add key="CITIHandCardWordTemplateFile" value="report-template\\\\CitiPower Hand Card.doc" />\n<add key="PCORHandCardWordTemplateFile" value="report-template\\\\Powercor Hand Card.doc" />\n<add key="MaxConcurrentRequestsLimit" value="2" />\n<add key="MaxQueueRequestsLimit" value="8" />\n<add key="AsposeLicense" value="Aspose.Total.lic" />\n<add key="EwbBaseUrl" value="http://localhost:9000/" />\n<add key="ValidPermitsOnly" value="true" />\n<add key="CollateSWLogFields" value="0" />\n<add key="serilog:write-to:File.outputTemplate" value="{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} &lt;{ThreadId}&gt; &lt;{RequestId}&gt;{NewLine}{Exception}" />\n<add key="serilog:write-to:File.retainedFileCountLimit" value="10" />\n<add key="serilog:minimum-level" value="Debug" />\n<cdmAppSettings>\n    <add key="BaseUrl" value="http://localhost:9988/" />\n    <add key="Username" value="xxx" />\n    <add key="Password" value="yyy" />\n    <add key="TrustAllCertificates" value="false" />\n    <add key="VerifyHost" value="true" />\n</cdmAppSettings>\n<permitTemplates>\n    <add key="default" value="report-template\\\\NP_TEST_PERMIT" />\n    <add key="Access Permit" value="report-template\\\\NP_ACCESS_PERMIT" />\n    <add key="Live Line Permit" value="report-template\\\\NP_LIVE_LINE_PERMIT" />\n    <add key="Close Working Zone Permit" value="report-template\\\\NP_CLOSE_WORKING_ZONE_PERMIT" />\n</permitTemplates>\n\x3c!-- Use ONE of these two connection string formats depending on database format (Oracle or MS SQL Server) --\x3e\n\x3c!-- SQL Server: --\x3e\n<add name="EdnarDB" connectionString="Server=my-sql-server;Database=ednar;User Id=ednar;Password=password;" />\n\x3c!-- Oracle: --\x3e\n<add name="EdnarDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=EDNAR;Password=password;" />\n\x3c!-- See above EdnarDB format for SQL Server DmsDB connection strings--\x3e\n<add name="DmsDb" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=enmac;Password=password;" /> or use environment variable `DMS_DB_CONN_STR`\n'})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Config Item"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"EdnarReportingServicePort"})}),(0,r.jsx)(t.td,{children:"EdnarReportingService port number"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"LogFileRelativePath"})}),(0,r.jsxs)(t.td,{children:["Path of the log files relative to the deployment directory. A path of Logs\\ will create the log file in ",(0,r.jsx)(t.code,{children:"C:\\EdnarService\\Logs"})," if the deployment directory is ",(0,r.jsx)(t.code,{children:"C:\\EdnarService"}),". Log file is created in text format and the rolling interval is set to a day."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"ServerBaseUrl"})}),(0,r.jsx)(t.td,{children:"Base server URL that will be used by the client to send http requests e.g. https://+:."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"LocalRequestOnly"})}),(0,r.jsx)(t.td,{children:"The flag to set if only the local request is valid."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"ReportTemplateFile"})}),(0,r.jsx)(t.td,{children:"The switching instruction report template file path including the filename."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"DocumentDefinitionFile"})}),(0,r.jsx)(t.td,{children:"The switching instruction document definition XML file path including the filename."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"CustomersExcelTemplateFile"})}),(0,r.jsx)(t.td,{children:"The customers report template file, including the path name."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"CustomersExcelTemplateFilePON"})}),(0,r.jsx)(t.td,{children:"The customers report template file that will be used for PON, including the path name"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"CITIHandCardWordTemplateFile"})}),(0,r.jsx)(t.td,{children:"The hand card template of CitiPower, including the path name"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"PCORHandCardWordTemplateFile"})}),(0,r.jsx)(t.td,{children:"The hand card template of Powercor, including the path name"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"MaxConcurrentRequestsLimit"})}),(0,r.jsx)(t.td,{children:"The maximum count of reports that will be created at the same time. This limits the memory consumption of the service."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"MaxQueueRequestsLimit"})}),(0,r.jsx)(t.td,{children:"The maximum count of requests that will be put into queue once MaxConcurrentRequestsLimit has been reached. This affects users having to wait for a long time for the report to be generated. Instead, once the limit has been reached, the service will immediately return 503 Service Unavailable."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"AsposeLicense"})," (optional)"]}),(0,r.jsx)(t.td,{children:"The Aspose license file, including the path name. When not specified, the license should be on the same directory with the executable files."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"EwbBaseUrl"})}),(0,r.jsx)(t.td,{children:"HTTP base url of the Energy Workbench Server. Note: /ewb is not defined in the service. Hence; must be included in the base url."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"ValidPermitsOnly"})}),(0,r.jsx)(t.td,{children:"Flag to set if only valid permits (e.g. permits attached to a current/valid switching step) should be printed. Default is True."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"CollateSWLogFields"})," (optional)"]}),(0,r.jsx)(t.td,{children:"Flag to set if COLLATE_SW_LOG_FIELDS is enabled in the ENMAC.SYSTEM_PARAMETERS DMS database table. 1 for true, 0 for false, default is 0"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"serilog:write-to:File.outputTemplate"})," (optional)"]}),(0,r.jsx)(t.td,{children:"Sets the output template of file log."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"serilog:write-to:File.retainedFileCountLimit"})," (optional)"]}),(0,r.jsx)(t.td,{children:"The maximum number of log files that will be retained, including the current log file. Defaults to 31 when not specified."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"serilog:minimum-level"})," (optional)"]}),(0,r.jsx)(t.td,{children:"Sets the minimum log level."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"cdmAppSettings"})," - ",(0,r.jsx)(t.code,{children:"BaseUrl"})]}),(0,r.jsx)(t.td,{children:"HTTP base url of the customer data management service."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"cdmAppSettings"})," - ",(0,r.jsx)(t.code,{children:"Username"})]}),(0,r.jsx)(t.td,{children:"Username for authentication with customer data management service."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"cdmAppSettings"})," - ",(0,r.jsx)(t.code,{children:"Password"})]}),(0,r.jsx)(t.td,{children:"Password for authentication with customer data management service."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"cdmAppSettings"})," - ",(0,r.jsx)(t.code,{children:"TrustAllCertificates"})," (optional)"]}),(0,r.jsxs)(t.td,{children:["Defaults to ",(0,r.jsx)(t.code,{children:"true"}),", will not allow untrusted ssl certificate."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"cdmAppSettings"})," - ",(0,r.jsx)(t.code,{children:"VerifyHost"})," (optional)"]}),(0,r.jsxs)(t.td,{children:["Defaults to ",(0,r.jsx)(t.code,{children:"true"}),", will verify ssl certificate against hostname."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"permitTemplates"})," (optional)"]}),(0,r.jsx)(t.td,{children:"Collection of permit templates where key is the permit type and values is the path to the template file. Note that it needs to have a default key for the reporting service to fall back on when there is no config for the permit type or the specified config value of permit type is not found."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:["Connection String - ",(0,r.jsx)(t.code,{children:"EdnarDB"})]}),(0,r.jsx)(t.td,{children:"Specify the connection string for the EDNAR database, can be Oracle or MS SQL."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:["Connection String - ",(0,r.jsx)(t.code,{children:"DmsDb"})]}),(0,r.jsx)(t.td,{children:"Specify the connection string for the DMS database, can be Oracle or MS SQL."})]})]})]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"The port number needs to be consistent with the EDNAR App Server configuration."})})]})}function h(e={}){let{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:function(e,t,n){n.d(t,{R:()=>d,x:()=>l});var i=n(96540);let r={},s=i.createContext(r);function d(e){let t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);