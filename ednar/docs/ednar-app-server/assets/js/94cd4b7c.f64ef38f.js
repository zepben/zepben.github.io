"use strict";(self.webpackChunkednar_app_server=self.webpackChunkednar_app_server||[]).push([["8642"],{63003:function(e,t,n){n.r(t),n.d(t,{metadata:()=>r,default:()=>l,frontMatter:()=>i,contentTitle:()=>o,toc:()=>c,assets:()=>d});var r=JSON.parse('{"id":"export-sql-server-config","title":"Exporting SQL Server config","description":"This guide runs through the steps of exporting the EDNAR config data from one SQL Server database to another SQL Server database. There are a few other ways to do it, however most of those have issues in one way or another.","source":"@site/versioned_docs/version-5.1.0/export-sql-server-config.md","sourceDirName":".","slug":"/export-sql-server-config","permalink":"/ednar/docs/ednar-app-server/5.1.0/export-sql-server-config","draft":false,"unlisted":false,"tags":[],"version":"5.1.0","frontMatter":{"id":"export-sql-server-config","title":"Exporting SQL Server config","slug":"/export-sql-server-config"},"sidebar":"sidebar","previous":{"title":"App Options","permalink":"/ednar/docs/ednar-app-server/5.1.0/app-options"},"next":{"title":"Steps to debug EDNAR","permalink":"/ednar/docs/ednar-app-server/5.1.0/debugging-steps"}}'),s=n(74848),a=n(28453);let i={id:"export-sql-server-config",title:"Exporting SQL Server config",slug:"/export-sql-server-config"},o,d={},c=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Steps",id:"steps",level:3}];function h(e){let t={a:"a",code:"code",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"This guide runs through the steps of exporting the EDNAR config data from one SQL Server database to another SQL Server database. There are a few other ways to do it, however most of those have issues in one way or another."}),"\n",(0,s.jsx)(t.p,{children:"After following the steps below, you will be left with a fully functioning EDNAR database which only contains config data - all transactional data (NARs, Authorities, attachments etc.) will be deleted. The original/source database will not lose any data."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"An existing SQL Server database with EDNAR config (referred to as OLD_EDNAR in this guide)"}),"\n",(0,s.jsx)(t.li,{children:"A new blank SQL Server database that will be used for the new EDNAR DB (referred to as NEW_EDNAR in this guide)"}),"\n",(0,s.jsx)(t.li,{children:"SQL Server Management Studio (SSMS) installed, logged in as a user with write privileges on the new database (ideally the DB Owner or the user that EDNAR uses to connect to the database)"}),"\n",(0,s.jsxs)(t.li,{children:["This SQL file to remove transactional data and reset the database sequences: ",(0,s.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(85415).A+"",children:"click to download"})]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"steps",children:"Steps"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"1."})," In SSMS, open the Object Explorer and locate OLD_EDNAR under the Databases folder. Right click it, then go down to ",(0,s.jsx)(t.code,{children:"Tasks"})," > ",(0,s.jsx)(t.code,{children:"Back Up..."}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"2."})," In the Back Up Database wizard on the General page, make sure the correct database is selected and the ",(0,s.jsx)(t.code,{children:"Backup type"})," is set to Full. Under ",(0,s.jsx)(t.code,{children:"Destination"}),", select ",(0,s.jsx)(t.code,{children:"Back up to: Disk"}),", then in the box below press ",(0,s.jsx)(t.code,{children:"Add..."}),".\nMake sure ",(0,s.jsx)(t.code,{children:"File name:"})," is checked, then select a location to create the backup. Set an appropriate filename (e.g. OLD_EDNAR-DD-MM-YYYY.bak) then hit OK. If there are other backup files in the ",(0,s.jsx)(t.code,{children:"Destination"})," box, remove them using the button on the right."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"3."})," The rest of the pages should be fine to continue with the default options. Hit OK on the ",(0,s.jsx)(t.code,{children:"General"})," page to create the backup."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"4."})," Back in the Object Explorer, find the NEW_EDNAR database. Right click it, then go down to ",(0,s.jsx)(t.code,{children:"Tasks"})," > ",(0,s.jsx)(t.code,{children:"Restore"})," > ",(0,s.jsx)(t.code,{children:"Database"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"5."})," In the wizard under ",(0,s.jsx)(t.code,{children:"Source"}),", either select ",(0,s.jsx)(t.code,{children:"Database:"})," and choose OLD_EDNAR, or choose ",(0,s.jsx)(t.code,{children:"Device:"}),", then ",(0,s.jsx)(t.code,{children:"Add"})," and locate the backup file (*.bak) you created earlier.\nMake sure the Destination database is NEW_EDNAR."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"6."})," On the ",(0,s.jsx)(t.code,{children:"Options"})," page of the wizard, check the ",(0,s.jsx)(t.code,{children:"Overwrite the existing database"})," box. If you've already set up replication, check the ",(0,s.jsx)(t.code,{children:"Preserve the replication settings"})," box as well. Everything else can stay as the default settings."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"7."})," Back on the ",(0,s.jsx)(t.code,{children:"General"})," page, hit OK. Verify the restore has worked by opening NEW_EDNAR > Tables and verifying that the EDNAR tables are now listed."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"8."})," Right click NEW_EDNAR again, the hit ",(0,s.jsx)(t.code,{children:"New Query"}),". Copy the contents of ",(0,s.jsx)(t.code,{children:"delete-transactional-data+restart-sequences.sql"})," (download link above) into the query editor. Read the warnings at the top of the file, then hit ",(0,s.jsx)(t.code,{children:"Execute"})," in the toolbar above (or press F5) to run the SQL."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"9."})," Once run, point EDNAR at NEW_EDNAR in the config file, then start it. If everything has worked as expected, EDNAR should run up without issue, and when a new NAR is created, the ID should start at 1."]})]})}function l(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},85415:function(e,t,n){n.d(t,{A:()=>r});let r=n.p+"assets/files/delete-transactional-data+restart-sequences-e3a4c871e447c8dfb70a2703484639d6.sql"},28453:function(e,t,n){n.d(t,{R:()=>i,x:()=>o});var r=n(96540);let s={},a=r.createContext(s);function i(e){let t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);