"use strict";(self.webpackChunkednar_app_server=self.webpackChunkednar_app_server||[]).push([["2950"],{16226:function(e,n,t){t.r(n),t.d(n,{metadata:()=>i,default:()=>E,frontMatter:()=>o,contentTitle:()=>a,toc:()=>d,assets:()=>c});var i=JSON.parse('{"id":"ednar-oms-service","title":"EDNAR OMS Service","description":"The implementation of the EDNAR OMS Service is bespoke, as its operation requires integration with other corporate systems.","source":"@site/versioned_docs/version-5.1.0/ednar-oms-service.md","sourceDirName":".","slug":"/ednar-oms-service","permalink":"/ednar/docs/ednar-app-server/5.1.0/ednar-oms-service","draft":false,"unlisted":false,"tags":[],"version":"5.1.0","frontMatter":{"id":"ednar-oms-service","title":"EDNAR OMS Service","slug":"/ednar-oms-service"},"sidebar":"sidebar","previous":{"title":"EDNAR Controller PDF","permalink":"/ednar/docs/ednar-app-server/5.1.0/ednar-controller-pdf"},"next":{"title":"Customer Details","permalink":"/ednar/docs/ednar-app-server/5.1.0/api/customers"}}'),s=t(74848),r=t(28453);let o={id:"ednar-oms-service",title:"EDNAR OMS Service",slug:"/ednar-oms-service"},a="Introduction",c={},d=[];function l(e){let n={admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"introduction",children:"Introduction"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"The implementation of the EDNAR OMS Service is bespoke, as its operation requires integration with other corporate systems."})}),"\n",(0,s.jsx)(n.p,{children:"EDNAR OMS Service runs as a windows service to synchronize customer notifications between EDNAR and OMS database at a specified time interval."}),"\n",(0,s.jsxs)(n.p,{children:["Customer notifications will be saved in OMS database by executing a stored procedure named ",(0,s.jsx)(n.code,{children:"save_nar_customer_notifications"}),", passing in sql type ",(0,s.jsx)(n.code,{children:"nars_typ"}),". See SQL Type section for the type structure."]}),"\n",(0,s.jsx)(n.p,{children:"The software runs as a windows service. It is built using .NET and can run only on windows."}),"\n",(0,s.jsx)("hr",{}),"\n",(0,s.jsx)(n.h1,{id:"required-software",children:"Required Software"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Atleast Windows 7 operating system with SP1 or above is required"}),"\n",(0,s.jsx)(n.li,{children:".NET Framework 4.6.2"}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"installing-ednar-oms-service",children:"Installing EDNAR-OMS Service"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"You need administrator privileges to install the service."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Login to the windows machine in which ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," needs to be installed."]}),"\n",(0,s.jsxs)(n.li,{children:["Create a folder ",(0,s.jsx)(n.code,{children:"EdnarOmsService"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Copy all the EDNAR-OMS Service binaries from the ",(0,s.jsx)(n.code,{children:".zip"})," file of the release to this folder."]}),"\n",(0,s.jsx)(n.li,{children:"Change the config file to make sure it is correct in the running environment."}),"\n",(0,s.jsxs)(n.li,{children:["Run Powershell as an administrator and use it to navigate to the ",(0,s.jsx)(n.code,{children:"EdnarOmsService"})," directory."]}),"\n",(0,s.jsxs)(n.li,{children:["Run  ",(0,s.jsx)(n.code,{children:".\\ednar-oms-service.exe install"})," and wait for a message to say that it was successfully installed."]}),"\n",(0,s.jsx)(n.li,{children:"You should get the installed successfully message."}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," windows service is installed at this point."]}),"\n",(0,s.jsx)(n.li,{children:"Go to the Services console in windows."}),"\n",(0,s.jsxs)(n.li,{children:["Make sure the ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," service is running. If not, start it."]}),"\n",(0,s.jsxs)(n.li,{children:["Check the properties of the ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," service to ensure that it is configured to start automatically."]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"uninstalling-ednar-oms-service",children:"Uninstalling EDNAR-OMS Service"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"You need administrator privileges to uninstall the service."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Login to the windows machine in which ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," is installed."]}),"\n",(0,s.jsx)(n.li,{children:"Run Powershell as an administrator."}),"\n",(0,s.jsxs)(n.li,{children:["Navigate to ",(0,s.jsx)(n.code,{children:"C:\\EdnarOmsService"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Run the command ",(0,s.jsx)(n.code,{children:".\\ednar-oms-service.exe uninstall"})]}),"\n",(0,s.jsx)(n.li,{children:"You should get an uninstall successful message."}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"configuring-ednar-oms-service",children:"Configuring Ednar-OMS Service"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Navigate to ",(0,s.jsx)(n.code,{children:"C:\\EdnarOmsService"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Open the file ",(0,s.jsx)(n.code,{children:"ednar-oms-service.exe.config"})," in the text editor of choice."]}),"\n",(0,s.jsxs)(n.li,{children:["Update the configuration items as specified below. Save and close the file. Restart ",(0,s.jsx)(n.code,{children:"EDNAR-OMS Service"})," for the new configuration to take effect."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<add key="DBConnectionRetries" value="2" />\n<add key="RunInterval" value="60" />\n<connectionStrings>\n    <add name="EdnarOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n    <add name="DMSOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521))(CONNECT_DATA=(FAILOVER_MODE=(TYPE=select)(METHOD=basic))(SERVER=dedicated)(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n    <add name="PonOracleDB" connectionString="Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.30.129)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=nms)));User Id=username;Password=********;" />\n</connectionStrings>\n'})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Config Item"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DBConnectionRetries"}),(0,s.jsx)(n.td,{children:"Number of retries the service will use to try to connect to the database before giving up."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"RunInterval"}),(0,s.jsx)(n.td,{children:"The amount of time in seconds that the service will sleep before running a new task."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:["Connection String - ",(0,s.jsx)(n.code,{children:"EdnarDB"})]}),(0,s.jsx)(n.td,{children:"Specify the connection string for the EDNAR database in oracle."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:["Connection String - ",(0,s.jsx)(n.code,{children:"OmsDB"})]}),(0,s.jsx)(n.td,{children:"Specify the connection string for the OMS database in oracle."})]})]})]}),"\n",(0,s.jsx)(n.h1,{id:"sql-type",children:"SQL Type"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- Customer Notification Template\nCREATE OR REPLACE TYPE template_typ AS OBJECT (\n   id NUMBER(38,0),\n   name VARCHAR2(256)\n);\n\n-- Customer Notification Task NMI\nCREATE OR REPLACE TYPE nmi_typ AS OBJECT (\n   nmi VARCHAR2(256)\n);\nCREATE OR REPLACE TYPE nmis_typ AS TABLE OF nmi_typ;\n\n\n-- Customer Notification Event Reason Type\nCREATE OR REPLACE TYPE customer_notification_event_reason_typ AS OBJECT (\n   id NUMBER(38,0),\n   name VARCHAR2(256),\n   type VARCHAR2(128)\n);\n\n-- Customer Notification Event\nCREATE OR REPLACE TYPE customer_notification_event_typ AS OBJECT (\n   id NUMBER(38,0),\n   template template_typ,\n   reason customer_notification_event_reason_typ,\n   created_on TIMESTAMP(6),\n   nmis nmis_typ\n);\nCREATE OR REPLACE TYPE customer_notification_events_typ AS TABLE OF customer_notification_event_typ;\n\n-- Customer Notification\n-- Customer Notification Task\nCREATE OR REPLACE TYPE customer_notification_task_typ AS OBJECT(\n   company VARCHAR2(128),\n   description VARCHAR2(256),\n   outage_start TIMESTAMP(6),\n   outage_end TIMESTAMP(6),\n   template template_typ,\n   delivery_method VARCHAR2(256),\n   nmis nmis_typ,\n   events customer_notification_events_typ\n);\nCREATE OR REPLACE TYPE customer_notification_tasks_typ AS TABLE OF customer_notification_task_typ;\n\n-- NAR Access Type\nCREATE OR REPLACE TYPE access_type_typ AS OBJECT(\n   id NUMBER(38,0),\n   name VARCHAR2(128)\n);\n\n-- NAR Job Type\nCREATE OR REPLACE TYPE job_type_typ AS OBJECT(\n   id NUMBER(38,0),\n   name VARCHAR2(128)\n);\n\n-- User\nCREATE OR REPLACE TYPE user_typ AS OBJECT (\n   username VARCHAR2(256),\n   first_name VARCHAR2(128),\n   last_name VARCHAR2(128),\n   email VARCHAR2(256),\n   fax VARCHAR2(32),\n   depot VARCHAR2(64),\n   mobile VARCHAR2(32),\n   phone VARCHAR2(32),\n   position VARCHAR2(128)\n);\n\n-- NAR Comment\nCREATE OR REPLACE TYPE nar_comment_typ AS OBJECT (\n    id NUMBER(38, 0),\n    comment_timestamp TIMESTAMP(6),\n    comment_user user_typ,\n    type VARCHAR2(100),\n    text VARCHAR2(4000)\n);\nCREATE OR REPLACE TYPE nar_comments_typ AS TABLE OF nar_comment_typ;\n\n-- NAR Participant\n-- Participant Type\nCREATE OR REPLACE TYPE participant_typ AS OBJECT (\n   participant_type VARCHAR2(128),\n   participant_user user_typ\n);\nCREATE OR REPLACE TYPE participants_typ AS TABLE OF participant_typ;\n\n-- NAR\nCREATE OR REPLACE TYPE nar_typ AS OBJECT(\n   id NUMBER(38,0),\n   state VARCHAR2(128),\n   access_type access_type_typ,\n   job_type job_type_typ,\n   start_date_time TIMESTAMP(6),\n   end_date_time TIMESTAMP(6),\n   primary_equipment_container VARCHAR2(128),\n   work_title VARCHAR2(128),\n   location VARCHAR2(128),\n   participants participants_typ,\n   customer_notification_tasks customer_notification_tasks_typ,\n   comments nar_comments_typ\n);\nCREATE OR REPLACE TYPE nars_typ AS TABLE OF nar_typ\n"})})]})}function E(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:function(e,n,t){t.d(n,{R:()=>o,x:()=>a});var i=t(96540);let s={},r=i.createContext(s);function o(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);